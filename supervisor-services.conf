[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[program:ollama]
command=/usr/local/bin/ollama serve
directory=/data/ollama
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/supervisor/ollama.err.log
stdout_logfile=/var/log/supervisor/ollama.out.log
environment=OLLAMA_HOST="0.0.0.0",OLLAMA_MODELS="/data/ollama/models"
priority=10

[program:surrealdb]
command=/usr/local/bin/surreal start --user root --pass root --bind 0.0.0.0:8000 file:/data/surrealdb/database.db
directory=/data/surrealdb
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/supervisor/surrealdb.err.log
stdout_logfile=/var/log/supervisor/surrealdb.out.log
priority=10

[program:searxng]
command=python3.11 -m searx.webapp
directory=/opt/searxng
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/supervisor/searxng.err.log
stdout_logfile=/var/log/supervisor/searxng.out.log
environment=SEARXNG_SETTINGS_PATH="/data/searxng/settings.yml",SEARXNG_PORT="8080",SEARXNG_BIND_ADDRESS="0.0.0.0"
priority=20

[program:serena]
command=python3.11 -m serena.server --host 0.0.0.0 --port 8384
directory=/data/serena
autostart=true
autorestart=true
startretries=3
stderr_logfile=/var/log/supervisor/serena.err.log
stdout_logfile=/var/log/supervisor/serena.out.log
priority=20

[group:claudia-services]
programs=ollama,surrealdb,searxng,serena
priority=999
